

Ch06 ç™½ç®±æ¸¬è©¦
===

ç™½ç®±æ¸¬è©¦æ˜¯åªåœ¨çŸ¥é“ç¨‹å¼çš„å…§éƒ¨çµæ§‹ä¸‹é€²è¡Œçš„æ¸¬è©¦ï¼Œå…¶æ¸¬è©¦çš„ç›®çš„æ˜¯äº†è§£ç¨‹å¼ç¢¼è¢«æ¸¬è©¦çš„ç¨‹åº¦ã€‚

:::success
**White Box Testing**
A method of testing software that tests internal structures or workings of an application, as opposed to its functionality (i.e. black-box testing)}
:::

## ğŸ§‘â€ğŸ’»Labæ¶µè“‹åº¦ 

[æ¶µè“‹åº¦ Lab](https://github.com/nlhsueh/sw-testing24/blob/main/lab/u04_utest/whitebox_test.md)

## æ¸¬è©¦æ¶µè“‹åº¦

```java=
input A,B,X 
if (A>1) and (B=0) then
  Y=A 
if (A=2) or (X>1) then
  Y=X 
print Y
```

### æ•˜è¿°æ¶µè“‹åº¦

*è¨­è¨ˆæ¸¬è©¦æ¡ˆä¾‹ï¼Œä½¿æ¯ä¸€æ¢æŒ‡ä»¤æ•˜è¿°è‡³å°‘åŸ·è¡Œä¸€æ¬¡*ã€‚è¼¸å…¥ç‚º (A,B,X) = (2,0,3) å°±å¯è¦†è“‹æ‰€æœ‰å¯åŸ·è¡ŒæŒ‡ä»¤ï¼Œçµæœæœƒå¾—åˆ° 3ã€‚å³ä¾¿æ‰€æœ‰çš„æ•˜è¿°éƒ½è¢«åŸ·è¡Œäº†ï¼Œæ­¤æ–¹æ³•ä¸¦ä¸æ˜¯å¾ˆã€Œåš´è¬¹ã€çš„æ–¹æ³•ï¼šå¦‚æœæˆ‘å€‘çŠ¯äº†ä»¥ä¸‹çš„éŒ¯èª¤ï¼š

- è¡Œè™Ÿ 2 çš„ AND æ”¹æˆ ORï¼Œæˆ–æ˜¯ 
- è¡Œè™Ÿ 3 Y=A æ”¹æˆå…¶ä»–çš„æ•˜è¿° 
- è¡Œè™Ÿ 4 çš„ X>1 æ”¹æˆ X>0ï¼Œæˆ–æ˜¯ 

æ¸¬è©¦æ¡ˆä¾‹ (2,0,3) ä¸¦ä¸èƒ½æ‰¾å‡ºä½ çŠ¯çš„éŒ¯èª¤ï¼Œé€™è¡¨ç¤ºé€™çµ„æ¸¬è©¦æ¡ˆä¾‹å¤ªå¼±äº†ã€‚äº‹å¯¦ä¸Šï¼Œæ•˜è¿°è¦†è“‹æº–å‰‡æ˜¯é€™å¹¾å€‹æ–¹æ³•ä¸­æœ€å¼±çš„ä¸€å€‹ï¼Œç™½ç®±æ¸¬è©¦è‡³å°‘è¦åšåˆ°æ­¤æ¸¬è©¦ã€‚

### åˆ†æ”¯æ¶µè“‹åº¦
åˆ†æ”¯æ¶µè“‹åº¦ï¼ˆbranch coverageï¼‰åˆç¨±ç‚ºæ±ºç­–æ¶µè“‹åº¦ï¼ˆdecision coverageï¼‰ã€‚å…¶ç›®æ¨™æ˜¯è¨­è¨ˆæ¸¬è©¦æ¡ˆä¾‹ä½¿ç¨‹å¼æ¯å€‹åˆ¤æ–·å– *çœŸåˆ†æ”¯å’Œå–å‡åˆ†æ”¯è‡³å°‘åŸ·è¡Œä¸€æ¬¡*ã€‚ä¸Šè¿°çš„ä¾‹å­æœ‰å…©å€‹ branch:

- (A>1) AND (B=0)
- (A=2) OR (X>1)

æˆ‘å€‘å¿…é ˆè¨­è¨ˆä¸€äº›æ¸¬è©¦è³‡æ–™è®“é€™å…©å€‹ branch çš„çœŸå‡éƒ½è‡³å°‘ä¸€æ¬¡ã€‚
A,B,Xè‹¥ç‚º(3,0,3)å’Œ(3,1,1)èƒ½ä½¿å¾— (A>1) AND (B=0)å’Œ(A=2) OR (X>1)é€™å…©å€‹å¸ƒæ—é‹ç®—å¼å‡èƒ½ç”¢ç”ŸçœŸå’Œå‡çš„å€¼ã€‚ 

<img src=https://hackmd.io/_uploads/rkX6xoZNT.png width=400>

åˆ†æ”¯æ¶µè“‹åº¦æ‰€æ‰¾å‡ºä¾†çš„æ¸¬è©¦æ¡ˆä¾‹æœƒæ¯”æ•˜è¿°æ¶µè“‹åº¦çš„å¤šï¼Œä¹Ÿå› æ­¤æ¯”è¼ƒèƒ½æ‰¾å‡ºç¨‹å¼çš„éŒ¯èª¤ã€‚ä½†ï¼Œå¾ˆé¡¯ç„¶çš„ï¼Œä¹Ÿä¸å¯æ‰¾å‡ºæ‰€æœ‰çš„éŒ¯èª¤ã€‚ä¾‹å¦‚è‹¥æˆ‘å€‘å°‡ (A>1)å¯«æˆ(A>2)ï¼Œæ¶µè“‹åº¦ä¸€æ¨£ 100%ï¼ŒåŸ·è¡Œçµæœä¹Ÿä¸€æ¨£ï¼Œæˆ‘å€‘å°±ç„¡æ³•çŸ¥é“ç¨‹å¼å¯«éŒ¯äº†ã€‚

:question: é‡å°ä»»ä½•ç¨‹å¼ï¼Œæˆ‘å€‘ä¸€å®šå¯ä»¥æ‰¾åˆ°ä¸€ç¾¤æ¸¬è©¦æ¡ˆä¾‹ï¼Œä½¿å¾—åˆ†æ”¯æ¶µè“‹åº¦ç‚ºç™¾åˆ†ç™¾ï¼Ÿ

### æ¢ä»¶æ¶µè“‹åº¦

æ¢ä»¶è¦†è“‹ï¼ˆconditionï¼‰å’Œåˆ†æ”¯è¦†è“‹é¡ä¼¼ï¼Œä¸éæ¢ä»¶è¦†è“‹æ˜¯ä»¥æŸé …æ¢ä»¶ç‚ºä¸»ï¼Œè€Œæ±ºç­–æ¶µè“‹å‰‡ä»¥æ•´å€‹å¸ƒæ—é‹ç®—å¼ç‚ºä¸»ã€‚ä½¿ç¨‹å¼ä¸­æ¯å€‹åˆ¤æ–·çš„æ¯å€‹æ¢ä»¶è‡³å°‘åŸ·è¡Œä¸€æ¬¡ã€‚ä¾‹å¦‚ (A>1) AND (B=0) é‹ç®—å¼åŒ…å« A>1 å’Œ B=0 å…©æ¢ä»¶ã€‚å‰è¿°ç¨‹å¼å…·æœ‰ä¸‹åˆ—å››æ¢ä»¶ A>1ã€B=0ã€A=2ã€X>1ã€‚æ¬²ä½¿é€™å››å€‹æ¢ä»¶éƒ½èƒ½ç”¢ç”ŸçœŸèˆ‡å‡çš„å€¼ï¼Œæ¸¬è©¦æ¡ˆä¾‹é ˆåŒ…å«ä»¥ä¸‹å…«ç¨®æ¡ˆä¾‹ï¼š

```
(1) A>1, (2) A<=1 
(3) B=0, (4) B<>0 
(5) A=2, (6) A<>2 
(7) X>1, (8) X<=1 
```

æ¸¬è©¦è³‡æ–™ (2,0,3) æ»¿è¶³ (1)ã€(3)ã€(5)ã€(7)ã€‚(1,1,1) æ»¿è¶³(2)ã€(4)ã€(6)ã€(8)ã€‚å› æ­¤ï¼Œæ¸¬è©¦æ¡ˆä¾‹ {(2,0,3), (1,1,1)} ä¾¿å¯é”æˆé€™å€‹ç›®æ¨™ã€‚



:::warning
æ»¿è¶³ã€Œæ¢ä»¶æ¶µè“‹åº¦ã€çš„æ¸¬è©¦è³‡æ–™ï¼Œä¸€å®šæ»¿è¶³ã€Œåˆ†æ”¯æ¶µè“‹åº¦ã€å—ï¼Ÿ
:::

æ„Ÿè¦ºèµ·ä¾†å¾ˆåƒæ˜¯ï¼Œä½†ä¸¦éå¦‚æ­¤ï¼Œä¾‹å¦‚æ­¤ä¾‹ï¼š

|     | p    | q    | p & q  |
|-----|------|------|--------|
| t1  | True | False| False  |
| t2  | False| True | False  |

ä¸Šè¡¨ä¸­çš„ æ¸¬è©¦æ¡ˆä¾‹ t1, t2 é›–ç„¶å¯ä»¥æ˜¯æ¢ä»¶ p, q, éƒ½æœ‰ true, false, ä½† p\&q é€™å€‹åˆ†æ”¯çš„å€¼å»éƒ½æ˜¯ false çš„ã€‚

:::warning
å¯¦å‹™ä¸Šï¼Œé€šå¸¸æˆ‘å€‘ä½¿ç”¨ã€Œå¿«æ·æ±‚å€¼ã€(short-circuit evaluation) ä¾†é€²è¡Œé‚è¼¯é‹ç®—ï¼Œæ­¤é‹ç®—ä¸‹ï¼Œæ¢ä»¶æ¶µè“‹åº¦ç™¾åˆ†ç™¾ï¼Œä¹Ÿæœƒæ»¿è¶³åˆ†æ”¯æ¶µè“‹åº¦ç™¾åˆ†ç™¾ã€‚
:::

ä¸Šé¢çš„ä¾‹å­ï¼Œç•¶ p ç‚º False, q ä¸¦ä¸æœƒé€²è¡Œæ±‚å€¼ï¼Œç¨±ä¹‹ç‚ºã€Œå¿«æ·æ±‚å€¼ã€ã€‚

|     | p    | q    | p & q  |
|-----|------|------|--------|
| t1  | True | False| False  |
| t2  | False| **x** | False  |

å› æ­¤ï¼Œç‚ºäº†æ»¿è¶³ q ç‚º Trueï¼Œå¿…é ˆå¢åŠ ä¸€å€‹æ¸¬è©¦æ¡ˆä¾‹ï¼š

|     | p    | q    | p & q  |
|-----|------|------|--------|
| t1  | True | False| False  |
| t2  | False| x    | False  |
| t3  | True | **True** | **True**   |

å› æ­¤ï¼Œ(t1, t2, t3) å¯ä»¥æ»¿è¶³æ¢ä»¶æ¶µè“‹åº¦èˆ‡åˆ†æ”¯æ¶µè“‹åº¦ç™¾åˆ†ç™¾ã€‚

### åˆ†æ”¯èˆ‡æ¢ä»¶æ¶µè“‹åº¦

å¦‚ä¸Šç¯€æ‰€è¨€ï¼Œæ¢ä»¶è¦†è“‹åš´å¯†æ€§é€šå¸¸æ¯”æ±ºç­–è¦†è“‹é«˜ï¼Œ*ä½†éçµ•å°*ã€‚ä¾‹å¦‚ (1,0,3) å’Œ (2,1,1) é€™çµ„æ•¸æ“šï¼Œé›–ç„¶ä½¿ä¸Šè¿°å››å€‹æ¢ä»¶å‡ç”¢ç”ŸçœŸèˆ‡å‡çš„å€¼ï¼Œä½†ä¸¦æœªä½¿é‹ç®—å¼ (A>1) AND (B=0) å’Œ (A=2) OR (X>1) å…·æœ‰çœŸèˆ‡å‡çš„å€¼ã€‚ å› æ­¤ï¼Œã€åˆ†æ”¯èˆ‡æ¢ä»¶æ¶µè“‹åº¦ã€è¨­è¨ˆè¶³å¤ çš„æ¸¬è©¦æ¡ˆä¾‹ï¼Œä½¿åˆ¤æ–·ä¸­æ¯å€‹æ¢ä»¶çš„æ‰€æœ‰å¯èƒ½å€¼è‡³å°‘åŸ·è¡Œä¸€æ¬¡ï¼ŒåŒæ™‚æ¯å€‹åˆ¤æ–·çš„æ‰€æœ‰å¯èƒ½åˆ¤æ–·çµæœè‡³å°‘åŸ·è¡Œä¸€æ¬¡ã€‚ä¸Šä¾‹ä¸­ï¼Œ (2,0,3) å’Œ (1,1,1) å¯é”æˆæ­¤ç›®æ¨™ã€‚

> é †è‘—ç¨‹å¼çš„é‚è¼¯ä¾†åšæ¸¬è©¦ç„¡æ³•æª¢é©—åŠŸèƒ½ï¼Œåªèƒ½æª¢é©—æ¶µè“‹åº¦ã€‚

#### sample-code-01

:::success
é‡å°ä»¥ä¸‹ç¨‹å¼ 
1. è¨­è¨ˆä¸€æ¸¬è©¦æ¡ˆä¾‹é”åˆ°ç™¾åˆ†ç™¾æ•˜è¿°æ¶µè“‹åº¦ (SC100); 
2. è¨­è¨ˆä¸€æ¸¬è©¦æ¡ˆä¾‹é”åˆ°ç™¾åˆ†ç™¾æ¢ä»¶æ¶µè“‹åº¦ (CC100)ï¼Œä½†éç™¾åˆ†ç™¾åˆ†æ”¯æ¶µè“‹åº¦; 
3. è¨­è¨ˆä¸€æ¸¬è©¦æ¡ˆä¾‹é”åˆ°ç™¾åˆ†ç™¾åˆ†æ”¯æ¶µè“‹åº¦ (BC100)ï¼Œä½†éç™¾åˆ†ç™¾æ¢ä»¶æ¶µè“‹åº¦ (!CC100)ã€‚

```java
read(X, Y)
if ((X>10) && (Y==1))
    X=1;
else if ((X-Y) < 2)
    X=2;
if (Y >10)
    X=3;
print X
```

è«‹ç•«å‡º æ¸¬è©¦æ¶µè“‹è¡¨  ä¾†æª¢é©—ã€‚
:::


è¦å®Œæˆæ•˜è¿°æ¶µè“‹ (SC100) æ˜¯å®¹æ˜“çš„ï¼Œåªè¦èƒ½å¤ è®“ 03, 05, 07 çš„æ•˜è¿°é€²å…¥å³å¯ï¼Œå› æ­¤æˆ‘å€‘è¨­è¨ˆ (X=11, Y=1) åŠ (X=12, Y=11) å…©ç­†è³‡æ–™å³å¯é”åˆ°æ­¤æ¶µè“‹ã€‚

è¦å®Œæˆ CC100 å»ä¸ BC100ï¼Œè¡¨ç¤ºåœ¨è¤‡åˆæ¢ä»¶ä¸Šéœ€è¦åšè™•ç†ï¼Œä¹Ÿå°±æ˜¯ 02 è¡Œçš„æ¢ä»¶åˆ¤æ–·ã€‚å‡è¨­æ‰€æœ‰çš„æ¢ä»¶åˆ†åˆ¥æ˜¯ c1, c2, c3, c4ã€‚æˆ‘å€‘è®“é€™äº”å€‹æ¢ä»¶çš„ True False éƒ½ç¶“æ­·éï¼Œä½† b1 (c1\&\&c2) åªæœ‰ç¶“æ­· True, False å…¶ä¸­ä¸€å€‹ï¼Œå”¯ä¸€å¯è¡Œçš„æ˜¯ b1 åªç¶“é Falseã€‚å› æ­¤æ¸¬è©¦æ¡ˆä¾‹å¦‚ä¸‹ï¼š

|  X  |  Y  |  c1 |  c2 |  b1 |  c3 |  c4 |
|----|----|----|----|----|----|----|
|  9  |  1  |  F  |  T  | *F*  |  F  |  F  |
| 12 | 11 |  T  |  F  | *F*  |  T  |  T  |


è¦å®Œæˆ BC å»ä¸ CCï¼Œè¡¨ç¤º b1 å¿…é ˆç¶“æ­· T/Fï¼Œä½† c1 æˆ– c2 å…¶ä¸­ä¹‹ä¸€åªç¶“æ­· T/F å…¶ä¸­ä¸€å€‹ã€‚å› æ­¤æ¸¬è©¦æ¡ˆä¾‹å¦‚ä¸‹ã€‚å…¶ä¸­ c1 åªç¶“æ­· T, è€Œ b1 ç¶“æ­· T/Fã€‚

|  X  |  Y  |  c1 |  c2 |  b1 |  c3 |  c4 |
|----|----|----|----|----|----|----|
| 13 |  1 | *T*  |  T  |  T  |  -  |  F  |
| 12 | 11 | *T*  |  F  | *F*  |  T  |  T  |
| 12 |  2 | *T*  |  F  | *T*  |  F  |  F  |



### å¤šé‡æ¢ä»¶çµ„åˆæ¶µè“‹åº¦

```java=
input A,B,X 
if (A>1) and (B=0) then
  Y=A 
if (A=2) or (X>1) then
  Y=X 
print Y
```

å¤šé‡æ¢ä»¶çµ„åˆæ¶µè“‹ï¼ˆmultiple-condition combination coverageï¼‰çš„æ–¹æ³•æ˜¯å¾æ±ºç­–/æ¢ä»¶æ¶µè“‹æ–¹æ³•å»¶ä¼¸ï¼Œç›®æ¨™æ˜¯ä½¿æ¸¬è©¦è³‡æ–™æ¶µè“‹æ¯å€‹å¸ƒæ—é‹ç®—å¼ä¸­å„ç¨®æ¢ä»¶çµ„åˆã€‚ä¾‹å¦‚å‰è¿°ç¨‹å¼ï¼Œç¬¬ä¸€å€‹å¸ƒæ—é‹ç®—å¼æœ‰ä¸‹åˆ— 4 ç¨®æ¢ä»¶çµ„åˆï¼š

```java
(1) A>1ï¼ŒB=0  
(2) A>1ï¼ŒB<>0  
(3) A<=1ï¼ŒB=0  
(4) A<=1ï¼ŒB<>0  
```

ç¬¬äºŒå€‹å¸ƒæ—é‹ç®—å¼ä¹Ÿæœ‰ä¸‹åˆ—4ç¨®æ¢ä»¶çµ„åˆï¼š

```java
(5) A=2ï¼ŒX>1  
(6) A=2ï¼ŒX<=1  
(7) A<>2ï¼ŒX>1  
(8) A<>2ï¼ŒX<=1  
```

æ¸¬è©¦è³‡æ–™ (2,0,4) æ»¿è¶³1ã€5ã€‚(2,1,1) æ»¿è¶³ 2ã€6ã€‚(1,0,2) æ»¿è¶³3ã€7ã€‚(1,1,1) æ»¿è¶³4ã€8ã€‚å› æ­¤é€™å››å€‹æ¸¬è©¦è³‡æ–™æ‰€çµ„åˆæˆçš„æ¸¬è©¦è³‡æ–™ç¾¤ä¾¿å¯æ¶µè“‹ä¸Šè¿° 8 ç¨®æ¢ä»¶çµ„åˆã€‚ 


![å„ç¨®æ¶µè“‹åº¦çš„é—œä¿‚](https://hackmd.io/_uploads/BJgLrcZVT.png)


> Programmer å¿…é ˆè‡ªå·±é€²è¡Œå–®å…ƒæ¸¬è©¦ï¼Œé…åˆ JUnit åŠæ¶µè“‹åº¦æª¢æŸ¥å·¥å…·çš„ä½¿ç”¨ï¼Œæª¢æŸ¥è‡ªå·±çš„æ¸¬è©¦æ˜¯å¦è¶³å¤ ã€‚


### è·¯å¾‘æ¶µè“‹åº¦

ä¸Šè¿°çš„å¹¾ç¨®æ–¹æ³•ï¼Œæ¶µè“‹åº¦éƒ½æ˜¯ä»¥æ•˜è¿°ã€æ¢ä»¶æˆ–æ˜¯åˆ†æ”¯ç‚ºå–®ä½ï¼Œå¦‚æœæŠŠã€Œè·¯å¾‘ã€è€ƒé‡é€²å»å°±æœƒè¶Šè¤‡é›œã€‚ä¾‹å¦‚ä¸Šè¿°çš„ (2,0,4), (2,1,1), (1,0,2), (1,1,1) æ¸¬è©¦è³‡æ–™ï¼Œé›–ç„¶å¯ä»¥æŠŠæ‰€æœ‰çš„ æ•˜è¿°ã€æ¢ä»¶ã€åˆ†æ”¯éƒ½æ¶µè“‹ï¼Œä½†ä»¥è·¯å¾‘çš„è§’åº¦ä¾†çœ‹ï¼Œä»–åªæ¶µè“‹äº† a-c-e, a-b-e, a-b-d ç­‰ä¸‰å€‹è·¯å¾‘ã€‚

![path coverage](https://hackmd.io/_uploads/ryRlBc-4T.png)


```
(2,0,4): èµ° a-c-e 
(2,1,1): èµ° a-b-e  
(1,0,2): èµ° a-b-e 
(1,1,1): èµ° a-b-d  
```

ä¹Ÿå°±æ˜¯ a-c-d é€™å€‹è·¯å¾‘ä¸¦æ²’æœ‰èµ°éã€‚å¦‚æœæˆ‘å€‘è¦èµ°éæ‰€æœ‰è·¯å¾‘çš„è©±ï¼Œæˆ‘å€‘éœ€è¦ $2^2=4$ å€‹è·¯å¾‘ï¼Œé€™çœ‹èµ·ä¾†ä¸é›£ï¼Œä½†å¦‚æœæœ‰è¿´åœˆçš„è©±ï¼Œå‡è¨­èµ° 20 éï¼Œæˆ‘å€‘å°±éœ€è¦ $4^{20} = 2^{40}=1.0995116e+12$ï¼Œé€™å·²ç¶“å¤±å»æ¸¬è©¦çš„æ„ç¾©äº†ã€‚å³ä¾¿ a-c-d é€™å€‹è·¯å¾‘æœ‰å…¶æ„ç¾©ï¼ˆæˆ–è¨± c çš„å‹•ä½œå¯èƒ½æœƒå½±éŸ¿ d çš„è¡Œç‚ºï¼‰ï¼Œä½† all-path çš„æ¸¬è©¦æˆæœ¬å¯¦åœ¨å¤ªé«˜äº†ã€‚

çµ±æ•´äº†æœ¬ç¯€æ‰€è¬›çš„æ¶µè“‹åº¦çš„é—œä¿‚ã€‚æœ€ä¸Šæ–¹ï¼ˆè·¯å¾‘æ¶µè“‹åº¦ï¼‰æ˜¯æœ€åš´è¬¹çš„ï¼Œä¾åºå¾€ä¸‹ã€‚åˆ†æ”¯æ¶µè“‹åº¦èˆ‡æ¢ä»¶æ¶µè“‹åº¦æ²’æœ‰çµ•å°çš„é—œä¿‚ï¼Œå› æ­¤å¹³è¡Œã€‚åˆ†æ”¯æ¶µè“‹åº¦ç™¾åˆ†ç™¾æ™‚ï¼Œæ•˜è¿°æ¶µè“‹åº¦ä¹Ÿç‚ºç™¾åˆ†ç™¾ã€‚å€¼å¾—ä¸€æçš„æ˜¯ï¼Œæ¢ä»¶æ¶µè“‹åº¦ç™¾åˆ†ç™¾æ™‚ä¸¦ä¸ä¿è­‰æ•˜è¿°æ¶µè“‹åº¦ç‚ºç™¾åˆ†ç™¾ã€‚


### MC/DC æ¶µè“‹åº¦

MC/DCï¼ˆModified Condition/Decision Coverageï¼Œä¿®æ­£æ¢ä»¶/æ±ºç­–æ¶µè“‹ï¼‰æ˜¯ç™½ç®±æ¸¬è©¦ä¸­ç”¨æ–¼é©—è­‰è¤‡é›œå¸ƒæ—é‚è¼¯çš„é»ƒé‡‘æ¨™æº–ï¼Œå°¤å…¶åœ¨èˆªç©ºã€æ±½è»Šã€é†«ç™‚ç­‰ å®‰å…¨é—œéµï¼ˆSafety-Criticalï¼‰é ˜åŸŸä¸­ï¼Œé€šå¸¸æ˜¯å¼·åˆ¶è¦æ±‚çš„æ¨™æº–ã€‚

MC/DC çš„æ ¸å¿ƒç†å¿µæ˜¯ï¼š**ç¢ºä¿æ¯å€‹æ¢ä»¶ï¼ˆConditionï¼‰éƒ½èƒ½ç¨ç«‹åœ°å½±éŸ¿æ•´å€‹æ±ºç­–ï¼ˆDecisionï¼‰çš„æœ€çµ‚è¼¸å‡ºçµæœã€‚**

-----

#### ä¸€ã€ MC/DC çš„æ ¸å¿ƒè¦æ±‚

å°æ–¼ç¨‹å¼ç¢¼ä¸­çš„æ¯å€‹å¸ƒæ—æ±ºç­–ï¼ˆä¾‹å¦‚ *IF* èªå¥çš„åˆ¤æ–·å¼ï¼‰ï¼ŒMC/DC å¿…é ˆæ»¿è¶³ä»¥ä¸‹å››é …è¦æ±‚ï¼š

1.  **æ•˜è¿°æ¶µè“‹ (Statement Coverage)ï¼š** ç¨‹å¼ä¸­çš„æ¯å€‹å¯åŸ·è¡Œæ•˜è¿°éƒ½è‡³å°‘è¢«åŸ·è¡Œä¸€æ¬¡ã€‚
2.  **åˆ†æ”¯æ¶µè“‹ (Branch Coverage)ï¼š** æ¯å€‹æ±ºç­–çš„ True å’Œ False å…©ç¨®çµæœéƒ½è‡³å°‘è¢«åŸ·è¡Œä¸€æ¬¡ã€‚
3.  **æ¢ä»¶æ¶µè“‹ (Condition Coverage)ï¼š** æ¯å€‹å–®ç¨çš„å¸ƒæ—æ¢ä»¶éƒ½å¿…é ˆè¢«è©•ä¼°ç‚º True å’Œ False è‡³å°‘ä¸€æ¬¡ã€‚
4.  **ç¨ç«‹å½±éŸ¿ï¼ˆç¨ç«‹æ€§ï¼‰(Condition Independence)ï¼š** å°æ–¼æ±ºç­–ä¸­çš„æ¯å€‹æ¢ä»¶ $C_i$ï¼Œå¿…é ˆæ‰¾åˆ°ä¸€å°æ¸¬è©¦æ¡ˆä¾‹ï¼š
      * åœ¨é€™å°æ¡ˆä¾‹ä¸­ï¼Œ$C_i$ çš„å€¼ç™¼ç”Ÿè®ŠåŒ–ï¼ˆ$T \to F$ æˆ– $F \to T$ï¼‰ã€‚
      * **æ‰€æœ‰å…¶ä»–æ¢ä»¶çš„å€¼ä¿æŒä¸è®Šã€‚**
      * ç”±æ–¼ $C_i$ çš„è®ŠåŒ–ï¼Œ**æ•´å€‹æ±ºç­–çš„æœ€çµ‚çµæœä¹Ÿç™¼ç”Ÿäº†æ”¹è®Šã€‚**


#### äºŒã€ ç¨‹å¼ç¯„ä¾‹èˆ‡ MC/DC æ‡‰ç”¨

[See Example](https://docs.google.com/spreadsheets/d/1Vs-44wjK8ipsNIYTRjKBwxJ3flpK_LmxlxQ775O1EwM/edit?gid=0#gid=0)

### ç™¾åˆ†ç™¾æ¶µè“‹åº¦çš„è¿·æ€

åœ¨è»Ÿé«”é–‹ç™¼ä¸­ï¼Œæˆ‘å€‘é€šå¸¸**ä¸æœƒè¦æ±‚ç¨‹å¼ç¢¼è¦†è“‹ç‡ (Code Coverage) é”åˆ° 100%**ï¼Œé€™èƒŒå¾Œæœ‰å¹¾å€‹ä¸»è¦çš„åŸå› ï¼š

#### 1. æŠ•å…¥ç”¢å‡ºæ¯”ï¼ˆReturn on Investment, ROIï¼‰ä¸é«˜

* **é‚Šéš›æ•ˆç›Šéæ¸›ï¼š** å¾ 0% æé«˜åˆ° 80% æˆ– 90% çš„è¦†è“‹ç‡é€šå¸¸èƒ½å¸¶ä¾†å·¨å¤§çš„å“è³ªæå‡ã€‚ç„¶è€Œï¼Œå¾ 95% æé«˜åˆ° 100% æ‰€éœ€çš„**æ™‚é–“å’Œç²¾åŠ›æœƒå‘ˆæŒ‡æ•¸ç´šå¢é•·**ï¼Œä½†å¸¶ä¾†çš„**é¡å¤–åƒ¹å€¼æˆ–éŒ¯èª¤æ¸›å°‘é‡å»éå¸¸æœ‰é™**ã€‚
* **æˆæœ¬æ•ˆç›Šåˆ†æï¼š** ç‚ºäº†è¦†è“‹é‚£äº›æ¥µç«¯ã€é›£ä»¥è§¸ç™¼æˆ–æ¥µå°‘ç™¼ç”Ÿçš„ç¨‹å¼ç¢¼è·¯å¾‘ï¼ˆä¾‹å¦‚ï¼šéå¸¸ç½•è¦‹çš„éŒ¯èª¤è™•ç†ã€åƒ…åœ¨ç‰¹å®šç’°å¢ƒä¸‹æ‰æœƒç™¼ç”Ÿçš„ä»£ç¢¼ï¼‰ï¼Œå¾€å¾€éœ€è¦ç·¨å¯«è¤‡é›œä¸”ç¶­è­·æˆæœ¬é«˜çš„æ¸¬è©¦ã€‚é€™äº›æˆæœ¬é€šå¸¸è¶…éäº†æ½›åœ¨çš„å¥½è™•ã€‚

#### 2. ç¨‹å¼ç¢¼è¦†è“‹ç‡ä¸ç­‰æ–¼è»Ÿé«”å“è³ª

* **è¦†è“‹ç‡åªçœ‹ã€ŒåŸ·è¡Œã€ï¼š** 100% è¦†è“‹ç‡åªä¿è­‰äº†ä½ çš„æ¯ä¸€è¡Œç¨‹å¼ç¢¼éƒ½è¢«ã€ŒåŸ·è¡Œã€éã€‚å®ƒ**ç„¡æ³•ä¿è­‰**ï¼š
    * **æ­£ç¢ºæ€§ (Correctness)ï¼š** æ¸¬è©¦æ˜¯å¦æª¢æŸ¥äº†æ­£ç¢ºçš„**è¼¸å‡º**å’Œ**è¡Œç‚º**ã€‚ä½ å¯èƒ½åŸ·è¡Œäº†ç¨‹å¼ç¢¼ï¼Œä½†æ¸¬è©¦æ–·è¨€ (assertion) å»æ˜¯éŒ¯çš„æˆ–ä¸å®Œæ•´çš„ã€‚
    * **é‚è¼¯éŒ¯èª¤ (Logic Errors)ï¼š** ç¨‹å¼ç¢¼æœ¬èº«é‚è¼¯ä¸Šçš„éŒ¯èª¤ï¼Œä¾‹å¦‚ä½¿ç”¨äº†éŒ¯èª¤çš„é‹ç®—ç¬¦ ($a+b$ å¯«æˆ $a-b$)ã€‚è¦†è“‹ç‡ç„¡æ³•ç™¼ç¾é€™ç¨®éŒ¯èª¤ã€‚
    * **åŠŸèƒ½å®Œæ•´æ€§ (Completeness)ï¼š** ç¨‹å¼ç¢¼ä¸­**ç¼ºå°‘**æŸäº›æ‡‰æœ‰çš„åŠŸèƒ½æˆ–é‚è¼¯ï¼ˆä¾‹å¦‚ï¼šæ¼å¯«äº†è™•ç†æŸå€‹é‚Šç•Œæ¢ä»¶çš„ `if` èªå¥ï¼‰ã€‚è¦†è“‹ç‡åªæ¸¬è©¦ç¾æœ‰çš„ç¨‹å¼ç¢¼ã€‚
* **æ¸¬è©¦çš„ç›®çš„æ˜¯ã€Œé©—è­‰è¡Œç‚ºã€ï¼Œè€Œä¸æ˜¯ã€ŒåŸ·è¡Œä»£ç¢¼ã€ã€‚** è¿½æ±‚ 100% å®¹æ˜“è®“äººç”¢ç”Ÿè™›å‡çš„å®‰å…¨æ„Ÿã€‚

#### 3. é›£ä»¥æˆ–ä¸å€¼å¾—æ¸¬è©¦çš„ç¨‹å¼ç¢¼

æœ‰æ™‚å€™ï¼ŒæŸäº›ç¨‹å¼ç¢¼è·¯å¾‘åœ¨å¯¦éš›æ‡‰ç”¨ä¸­æ˜¯æ¥µé›£æˆ–ä¸å€¼å¾—æ¸¬è©¦çš„ï¼š

* **ç¬¬ä¸‰æ–¹æˆ–å¤–éƒ¨ç³»çµ±çš„ä»‹é¢ï¼š** èˆ‡å¤–éƒ¨ APIã€è³‡æ–™åº«ã€ä½œæ¥­ç³»çµ±çš„ä»‹é¢ç¨‹å¼ç¢¼ï¼Œæ¨¡æ“¬æˆ–æ¸¬è©¦é€™äº›ç’°å¢ƒå¯èƒ½éå¸¸è¤‡é›œä¸”ä¸ç©©å®šã€‚
* **é˜²ç¦¦æ€§ç¨‹å¼ç¢¼ (Defensive Code)ï¼š** ç”¨ä¾†æ•æ‰ç†è«–ä¸Šä¸æ‡‰ç™¼ç”Ÿçš„éŒ¯èª¤ï¼ˆä¾‹å¦‚ï¼š`switch` èªå¥ä¸­çš„ `default` è™•ç†ã€æ°¸é ä¸æœƒæ‹‹å‡ºçš„ç•°å¸¸ï¼‰ã€‚ç‚ºäº†è¦†è“‹å®ƒå€‘è€Œç·¨å¯«çš„æ¸¬è©¦å¾€å¾€æ˜¯äººç‚ºè£½é€ éŒ¯èª¤æ¢ä»¶ï¼Œå°å¯¦éš›å“è³ªå¹«åŠ©ä¸å¤§ã€‚
* **UI ç¨‹å¼ç¢¼æˆ–å–®æ¬¡åŸ·è¡Œç¨‹å¼ç¢¼ï¼š** æŸäº›ç‰¹å®šçš„ä½¿ç”¨è€…ä»‹é¢ (UI) ç¨‹å¼ç¢¼æˆ–åªæœ‰å–®æ¬¡åŸ·è¡Œé‚è¼¯çš„å•Ÿå‹•è…³æœ¬ï¼Œå¯èƒ½å¾ˆé›£é€éå–®å…ƒæ¸¬è©¦é€²è¡Œæœ‰æ•ˆè¦†è“‹ã€‚

**ç¸½çµèˆ‡æœ€ä½³å¯¦è¸**

æœ€ä½³çš„ç­–ç•¥æ˜¯è¨­å®šä¸€å€‹**é«˜ä¸”å‹™å¯¦çš„ç›®æ¨™**ï¼Œä¾‹å¦‚ **80% è‡³ 95%**ï¼Œä¸¦å°‡å‰©ä¸‹çš„ç²¾åŠ›æ”¾åœ¨ï¼š

1.  **è¦†è“‹é—œéµæ¥­å‹™é‚è¼¯ï¼š** ç¢ºä¿ç³»çµ±ä¸­æœ€æ ¸å¿ƒã€æœ€è¤‡é›œçš„éƒ¨åˆ†å¾—åˆ°å¾¹åº•æ¸¬è©¦ã€‚
2.  **é«˜å“è³ªçš„æ¸¬è©¦ï¼š** ç¢ºä¿æ¸¬è©¦æ¡ˆä¾‹ä¸åƒ…åŸ·è¡Œä»£ç¢¼ï¼Œé‚„èƒ½**é©—è­‰æ­£ç¢ºçš„è¼¸å‡ºå’Œè¡Œç‚º**ï¼ˆä¾‹å¦‚ï¼Œä½¿ç”¨å–®å…ƒæ¸¬è©¦ã€æ•´åˆæ¸¬è©¦ã€ç«¯åˆ°ç«¯æ¸¬è©¦ç­‰ï¼‰ã€‚
3.  **é‚Šç•Œæ¢ä»¶å’ŒéŒ¯èª¤è™•ç†ï¼š** ç‰¹åˆ¥é‡å°è¼¸å…¥çš„é‚Šç•Œå€¼ã€è² é¢æƒ…å¢ƒå’ŒéŒ¯èª¤è™•ç†é‚è¼¯ç·¨å¯«æ¸¬è©¦ã€‚

> ğŸ“Œ **ç¨‹å¼ç¢¼è¦†è“‹ç‡æ˜¯ä¸€å€‹æŒ‡æ¨™ï¼Œè€Œä¸æ˜¯ç›®æ¨™ã€‚** å®ƒçš„åƒ¹å€¼åœ¨æ–¼ä½œç‚ºä¸€å€‹**ç™¼ç¾æœªæ¸¬è©¦å€åŸŸçš„å·¥å…·**ï¼Œè€Œä¸æ˜¯ä¸€å€‹éœ€è¦é”æˆçš„ç¡¬æ€§æ¨™æº–ã€‚


## åŸºæœ¬è·¯å¾‘æ¸¬è©¦


åŸºæœ¬è·¯å¾‘æ¸¬è©¦ï¼ˆbasis path testingï¼‰ ç™½ç®±æ¸¬è©¦å¸¸è¦‹çš„æ–¹æ³•ï¼Œç”¨ä»¥é”æˆç™¾åˆ†ç™¾æ•˜è¿°æ¶µè“‹åº¦èˆ‡åˆ†æ”¯æ¶µè“‹åº¦ã€‚

#### basis-path-testing-grade
:::success
è¼¸å…¥ 50 å€‹ä»¥ä¸‹çš„å­¸ç”Ÿäººæ•¸ä¹‹æˆç¸¾ï¼Œæˆç¸¾é™å®šåœ¨ 0ï½100 åˆ†çš„ç¯„åœï¼Œè¨ˆç®—æ‰€æœ‰å­¸ç”Ÿæˆç¸¾çš„ç¸½å’Œ sumã€æœ‰æ•ˆè¼¸å…¥å­¸ç”Ÿæˆç¸¾å€‹æ•¸validï¼Œä»¥åŠå¹³å‡æˆç¸¾ averageã€‚
è¼¸å…¥ -999 è¡¨ç¤ºåœæ­¢è¼¸å…¥ã€‚è‹¥ valid=0ï¼Œå‰‡ average=-999ã€‚

```java
public double computeAverage(int[] grade) {
    // (1)
    int sum = 0, max=100, min=10, valid=0, index=0;
    double average;

    //                  (2)             (3)
    while (grade[index] != -999 && index < 50) {
        //               (4)                  (5)
        if (grade[index] >= min && grade[index] <= max) {
            // (6)
            sum += grade[index];
            valid++;
        } else {
            System.out.println("æˆç¸¾ç¯„åœéŒ¯èª¤"); // (7)
        }
        index++; // (8)
    }
    //       (9)
    if (valid > 0)
        average = (double) sum / valid; // (10)
    else
        average = -999; // (11)

    return average; // (12)
}
```
:::





#### Step 1. ç¹ªè£½æµç¨‹åœ–

åœ¨é€™å€‹éšæ®µï¼Œé€šå¸¸æ­¤æ–¹æ³•æœƒæŠŠæ‰€æœ‰çš„è¤‡åˆæ¢ä»¶æ‹†è§£æˆå–®ä¸€æ¢ä»¶ï¼Œä¾‹å¦‚ if (x && y) è¦æ‹†æˆ if (x) .... if (y) ... çš„çµæ§‹ã€‚ç•¶æˆ‘å€‘æŠŠè¤‡åˆæ¢ä»¶æ‹†è§£å¾Œï¼ŒåŸºæœ¬è·¯å¾‘æ¸¬è©¦å¯ä»¥é”åˆ°ç™¾åˆ†ç™¾æ¢ä»¶æ¶µè“‹åº¦ã€‚

#### Step 2. è¨ˆç®—è¿¥åœˆè¤‡é›œåº¦ 

Cyclomatic Complexity ä»£è¡¨ç¨‹å¼åœ¨æ¢ä»¶åˆ¤æ–·çš„è¤‡é›œåº¦ï¼ŒCC è¶Šé«˜ï¼Œè¡¨ç¤ºæˆ‘å€‘éœ€è¦æ¸¬è©¦çš„è·¯å¾‘è¶Šå¤šã€‚è¨ˆç®—æ–¹æ³•ç‚ºï¼š

> CC(G) = å€åŸŸç©ºé–“å€‹æ•¸=é‚Šçš„å€‹æ•¸-ç¯€é»å€‹æ•¸+2=åˆ¤æ–·ç¯€é»å€‹æ•¸ +1 

å…¶ä¸­å€åŸŸç©ºé–“è¡¨ç¤ºè¢«å€éš”é–‹çš„ç¨ç«‹ç©ºé–“ï¼Œåœ¨åœ–ä¸­ï¼Œä¾‹å¦‚é» 2-3-9 æ‰€åŒ…è¦†çš„ç©ºé–“ã€9-11-10-12ã€4-7-5ã€5-7-6, 2-3-4-5-6-7-8 ç­‰åŠå¤–éƒ¨çš„ç©ºé–“ç­‰å…±å…­å€‹å€åŸŸç©ºé–“ã€‚æˆ–æ˜¯ç”¨åˆ¤æ–·ç¯€é»ä¾†è¨ˆç®—ï¼š2,3,4,5,9 éƒ½æ˜¯åˆ¤æ–·ç¯€é»ï¼Œ5+1 = 6 ä¸€æ¨£æ˜¯å…­å€‹å€åŸŸç©ºé–“ã€‚

![image](https://hackmd.io/_uploads/H1iSmLifyl.png)

ä¸‹åœ–å·¦å‘ˆç¾ä¸€å€‹æ²’æœ‰åˆ¤æ–·çš„ç¨‹å¼ç¢¼ï¼Œä¸€è·¯åŸ·è¡Œä¸‹ä¾†ï¼Œæ‰€ä»¥åªéœ€è¦ä¸€å€‹æ¸¬è©¦æ¡ˆä¾‹ã€‚è€Œä»–çš„ç©ºé–“ç‚ºä¸€ï¼Œä»£è¡¨å…¶ CC è¤‡é›œåº¦ç‚º 1ã€‚å³åœ–æ·»åŠ äº†ä¸€å€‹åˆ¤æ–·ï¼ŒCC è¤‡é›œåº¦ç‚º 2, è€Œæˆ‘å€‘éœ€è¦çš„æ¸¬è©¦æ¡ˆä¾‹ä¹Ÿè®Šæˆ 2ã€‚
![image](https://hackmd.io/_uploads/rkj3qfofkx.png)



#### Step 3. å°‹æ‰¾åŸºæœ¬è·¯å¾‘

æ‰¾å‡ºä¸€çµ„åŸºæœ¬ç¨ç«‹è·¯å¾‘ï¼Œæ•¸é‡ç‚º 6ã€‚é¦–å…ˆï¼Œä»»é¸ä¸€å€‹è·¯å¾‘ä½œç‚º path1, æ¥è‘—å»ºç«‹ path 2 ä¸è¦èµ° path1å·²ç¶“èµ°éçš„è·¯å¾‘ã€‚ä¾æ­¤é¡æ¨ã€‚

```
Pathl: 1-2-9-10-12
Path2: 1-2-9-11-12
Path3: 1-2-3-9-10-12
Path4: 1-2-3-4-7-8-2-â€¦
Path5: 1-2-3-4-5-7-8-2-â€¦
Path6: 1-2-3-4-5-6-7-8-2-â€¦
```

è·¯å¾‘å¾Œçœç•¥(â€¦)è¡¨ç¤ºå¯æ¥å—ä»»ä½•è·¯å¾‘ã€‚è¿¥åœˆè¤‡é›œæ€§ç‚º 6 è¡¨ç¤ºç¨ç«‹è·¯å¾‘æœ€å¤šå°±æ˜¯ 6, æ‰€ä»¥ä½ ä¸éœ€è¦å†å¾€ä¸‹æ‰¾ä¸‹å»ï¼Œæœ€å¤šå°±æ˜¯å…­å€‹è·¯å¾‘ã€‚

#### Step 5. è¨­è¨ˆæ¸¬è©¦æ¡ˆä¾‹

æ¥è‘—æˆ‘å€‘é–‹å§‹æ‰¾ç›¸é—œçš„æ¸¬è©¦è³‡æ–™ä¾†æ»¿è¶³é€™äº›æ¸¬è©¦è·¯å¾‘ã€‚


- Path l æ¸¬è©¦æ¡ˆä¾‹: 1-2-9-10-12ã€‚value(1) =-999ï¼Œæ‰€ä»¥valid=0ï¼Œç„¡æ³•é€²å…¥10ã€‚path1ä¸èƒ½è¢«å–®ç¨æ¸¬è©¦ï¼Œé ˆç‚ºè·¯å¾‘4ï¼Œ5ï¼Œ6æ¸¬è©¦ä¸­çš„ä¸€éƒ¨ä»½ã€‚

- Path 2 æ¸¬è©¦æ¡ˆä¾‹: 1-2-9-11-12ã€‚Value(1)=-999ã€‚æœŸæœ›è¼¸å‡º:  average =-999; sum =0ã€‚

- Path 3 æ¸¬è©¦æ¡ˆä¾‹: 1-2-3-9-10-12ã€‚å˜—è©¦è™•ç†ç¬¬101æˆ–æ›´å¤šçš„å€¼,è€Œå…¶ä¸­å‰100å€‹å€¼æ‡‰è©²æ˜¯æœ‰æ•ˆçš„ã€‚æœŸæœ›è¼¸å‡º: average =-999ã€‚

- Path 4 æ¸¬è©¦æ¡ˆä¾‹: 1-2-3-4-7-8-2-â€¦ã€‚Value(i) =æœ‰æ•ˆè¼¸å…¥ä¸” i<l00ã€‚Value(R) <æœ€å°å€¼ï¼ŒR<=iï¼ŒRæ˜¯å…¶ä¸­ä¸€å€‹è¼¸å…¥ç´¢å¼•ã€‚æœŸæœ›è¼¸å‡º:æ­£ç¢ºå¹³å‡å€¼å’Œç¸½æ•¸ã€‚

- Path 5 æ¸¬è©¦æ¡ˆä¾‹: 1-2-3-4-5-7-8-2-â€¦ã€‚Value(i) =æœ‰æ•ˆè¼¸å…¥i<l00ã€‚Value(R)>æœ€å¤§å€¼R<=iï¼ŒRæ˜¯å…¶ä¸­ä¸€å€‹è¼¸å…¥ç´¢å¼•ã€‚æœŸæœ›è¼¸å‡º:æ­£ç¢ºå¹³å‡å€¼å’Œç¸½æ•¸ã€‚

- Path 6 æ¸¬è©¦æ¡ˆä¾‹: 1-2-3-4-5-6-7-8-2- â€¦ã€‚Value(i) =æœ‰æ•ˆè¼¸å…¥i<l00ã€‚æœŸæœ›è¼¸å‡º:åŸºæ–¼iå€‹æ•¸å€¼çš„æ­£ç¢ºå¹³å‡æ•¸å’Œç¸½æ•¸ã€‚åŸ·è¡Œæ¯å€‹æ¸¬è©¦æ¡ˆä¾‹ï¼Œä¸¦èˆ‡æœŸæœ›è¼¸å‡ºæ¯”è¼ƒã€‚å®Œæˆæ‰€æœ‰æ¸¬è©¦æ¡ˆä¾‹å¾Œï¼Œä¿è­‰ç¨‹å¼ä¸­æ‰€æœ‰æ•˜è¿°éƒ½è‡³å°‘è¢«åŸ·è¡Œä¸€æ¬¡ã€‚

ç”±æ–¼åŸºæœ¬è·¯å¾‘æ¸¬è©¦æŠŠ branch å…§çš„ condition éƒ½æ‹†é–‹ä¾†ï¼Œä¸”ç¢ºä¿æ¯ä¸€å€‹ condition çš„çœŸå‡éƒ½æœ‰æˆç«‹éï¼Œæ‰€ä»¥å¯ä»¥æ»¿è¶³åˆ†æ”¯æ¶µè“‹åº¦èˆ‡æ¢ä»¶æ¶µè“‹åº¦ã€‚

:::success
ç•¶ç¨‹å¼ä¸­çš„é‚è¼¯é‹ç®—æ¡ç”¨ short circuit evaluation æ™‚ï¼Œæ¢ä»¶æ¶µè“‹åº¦ 100% å‰‡åˆ†æ”¯æ¶µè“‹åº¦ä¹Ÿç‚º `100%`; åˆ†æ”¯æ¶µè“‹åº¦è¨ˆç®—æ™‚çš„åˆ†æ¯ç‚º `2*n` å…¶ä¸­ `n` ç‚ºæ¢ä»¶çš„å€‹æ•¸ã€‚

ç¨‹å¼çš„ Cyclomatic Complexity ç‚º `n+1`; äº¦å³è¡¨ç¤ºå¯ä»¥è¨­è¨ˆè‡³å¤š `n+1` å€‹æ¸¬è©¦è³‡æ–™ï¼Œä½¿å¾—æ¢ä»¶æ¶µè“‹åº¦ 100%ã€‚ 
:::
    
## è³‡æ–™æµæ¸¬è©¦



è³‡æ–™æµæ¸¬è©¦ï¼ˆdata flow testingï¼‰è‘—çœ¼åœ¨è®Šæ•¸çš„å®šç¾©èˆ‡ä½¿ç”¨æ¸¬è©¦ã€‚å¾è³‡æ–™æµçš„è§’åº¦æª¢è¦–ç¨‹å¼æ˜¯å¦ç•°å¸¸çš„è§’åº¦ä¾†é€²è¡Œæ¸¬è©¦æ¡ˆä¾‹çš„è¨­è¨ˆã€‚å¾ä¸€å€‹è®Šæ•¸è¢«å®šç¾©åˆ°è¢«ä½¿ç”¨çš„è·¯å¾‘æ‡‰è©²æ¸¬è©¦ï¼Œ*é–‹å§‹æœ‰äº†ã€Œè·¯å¾‘ã€çš„æ¦‚å¿µ*ã€‚


- (d) defined: è³‡æ–™è¢«å®šç¾©ã€å»ºç«‹ã€åˆå§‹åŒ–ã€‚ç•¶è³‡æ–™è¢«çµ¦å®šæ–°å€¼ã€æª”æ¡ˆè¢«æ‰“é–‹ã€æˆ–å‹•æ…‹çš„åˆ†é…ç©ºé–“ç­‰ã€‚
- (k) killed: è³‡æ–™è¢«åˆªé™¤ã€é‡‹æ”¾ã€‚
- (u) used: è³‡æ–™è¢«åˆ©ç”¨ã€‚åˆå¯åˆ†ç‚º calculation è¨ˆç®—åˆ©ç”¨ (c-used) åŠ predicate åˆ¤æ–·åˆ©ç”¨ (p-used)ã€‚

ç•¶è®Šæ•¸å‡ºç¾åœ¨ä¸€å€‹ assignment æ•˜è¿°çš„å³æ–¹ï¼Œä¾‹å¦‚ m = x + 1; å°è®Šæ•¸ x è€Œè¨€æ­¤æ•˜è¿°ç‚ºå…¶ c-usedï¼Œå› ç‚ºå®ƒè¢«æ‹¿ä¾†è¨ˆç®—åˆ©ç”¨äº†ã€‚è‹¥è®Šæ•¸å‡ºç¾åœ¨ä¸€å€‹åˆ¤æ–·ä¸­ï¼Œä¾‹å¦‚ x==2ï¼Œå‰‡æ˜¯å…¶ p-usedã€‚

|               | Def | C-use       | P-use    |
|---------------|-----|-------------|----------|
| 1.  read (x, y); | x, y|             |          |
| 2.  z = x+2;   | z   | x           |          |
| 3.  if (z<y)   |     |             | z, y     |
| 4.  &nbsp; &nbsp; w = x + 1; | w   | x           |          |
| 5.  else       |     |             |          |
| 6.  &nbsp; &nbsp; y = y + 1; | y   | y           | 
| 7.  print (x, y, w, z); |     | x, y, z, w |          |


- *å…¨å®šç¾© (all def) è³‡æ–™æµæ¸¬è©¦*ï¼šå°æ–¼æ‰€æœ‰çš„è®Šæ•¸çš„å®šç¾©ï¼Œéƒ½æ‡‰è©²æœ‰ä¸€å€‹è·¯å¾‘å¾å®šç¾©åˆ°ä½¿ç”¨ï¼ˆp-use æˆ– c-useï¼‰èµ°éã€‚ 

    * ä»¥ä¸Šè¡¨çš„ x ç‚ºä¾‹ï¼Œæ‡‰è©²è¦æœ‰ä¸€çµ„æ¸¬è©¦è³‡æ–™é€šéè·¯å¾‘ `(1,2)`ã€‚å…¶ä»–çš„ def é‚„åŒ…å«ï¼šy: (1,6), z: (2, 7), w: (4, 7), y: (6, 7)ã€‚

- *å…¨è¨ˆç®—åˆ©ç”¨ (all c-uses) è³‡æ–™æµæ¸¬è©¦*ï¼šå°æ–¼æ‰€æœ‰è®Šæ•¸çš„è¨ˆç®—åˆ©ç”¨ï¼ˆc-useï¼‰ï¼Œéƒ½æ‡‰è©²è‡³å°‘æœ‰ä¸€å€‹è·¯å¾‘ï¼ˆå¾å®šç¾©åˆ°è¨ˆç®—ä½¿ç”¨ï¼‰èµ°éã€‚

    * ä»¥ä¸Šè¡¨çš„ x ç‚ºä¾‹ï¼Œæ‡‰è©²è¦æœ‰ä¸€çµ„æ¸¬è©¦è³‡æ–™é€šé (1,2), (1,4), (1,7) ã€‚


- *å…¨åˆ¤æ–·åˆ©ç”¨ (all p-uses) è³‡æ–™æµæ¸¬è©¦*:  å°æ–¼æ‰€æœ‰è®Šæ•¸çš„åˆ¤æ–·åˆ©ç”¨ï¼ˆp-useï¼‰ï¼Œéƒ½æ‡‰è©²è‡³å°‘æœ‰ä¸€å€‹è·¯å¾‘ï¼ˆå¾å®šç¾©åˆ°åˆ¤æ–·åˆ©ç”¨ï¼‰èµ°éã€‚

    * ä»¥ä¸Šè¡¨çš„ x ç‚ºä¾‹ï¼Œå› ç‚º x æ²’æœ‰ p-use, æ‰€ä»¥ä¸ç”¨ç›¸é—œçš„æ¸¬è©¦æ¡ˆä¾‹ã€‚

- *å…¨å®šç¾©-ä½¿ç”¨ (all-du) è³‡æ–™æµæ¸¬è©¦*: é‡å°æ¯ä¸€å€‹è®Šæ•¸ï¼Œå…¶æ¯ä¸€å€‹è®Šæ•¸å®šç¾© (def) åˆ°æ¯ä¸€å€‹è®Šæ•¸åˆ©ç”¨ (use) çš„ du è·¯å¾‘ï¼Œéƒ½æœ‰æ¸¬è©¦æ¡ˆä¾‹é€šéã€‚é€™æ˜¯è³‡æ–™æµæ¸¬è©¦ä¸­æœ€å®Œå‚™çš„ä¸€ç¨®æ¸¬è©¦ç­–ç•¥ï¼Œç•¶ç„¶å…¶èŠ±è²»çš„æˆæœ¬ä¹Ÿæœ€é«˜ã€‚

    * ä»¥ä¸Šè¡¨çš„ x ç‚ºä¾‹ï¼Œæ‡‰è©²è¦æœ‰ä¸€çµ„æ¸¬è©¦è³‡æ–™é€šé (1,2), (1,4), (1,7)ã€‚

ä¸‹åœ–ä»¥ Y ç‚ºä¾‹èªªæ˜ï¼š
![image](https://hackmd.io/_uploads/r1nTL5-4p.png)

#### all-du-testing

:::success
é‡å°ä»¥ä¸‹ç¨‹å¼ä¸­çš„X, è¨­è¨ˆæ¸¬è©¦æ¡ˆä¾‹ä½¿ä¹‹é”åˆ° all-du çš„ç™¾åˆ†ç™¾æ¶µè“‹åº¦ã€‚
```java
read (X, Y)
if ((X>10) || (Y==1))
   X=1;
else if ((X+Y) > 10)
  X=2;
if (Y >10)
   X=3; 
print x
```
:::

å…ˆåˆ—å‡ºæ‰€æœ‰çš„ X-def: 01, 03, 05, 07ã€‚æ‰€æœ‰çš„X-useï¼š02, 04, 08ã€‚å› ç‚ºæ˜¯ all-du çš„æ¶µè“‹åº¦ï¼Œæ‰€ä»¥å¿…é ˆç¶“éä»¥ä¸‹çš„ du pair: (01, 02), (01, 04), (01,08), (03, 04), (03, 08), (05, 07), (05, 08), (07, 08)ã€‚æœ‰äº›è·¯å¾‘æ˜¯ä¸å¯èƒ½é€šéçš„ï¼Œä¾‹å¦‚ (03,04)ã€‚


- du$_{(01,02)}$: (11, 1)
- du$_{(01,04)}$: (9, 2)
- du$_{(01,08)}$: (9, -2)ã€‚æ³¨æ„é€™å€‹æ¸¬è©¦æ¡ˆä¾‹ä¸æœƒé€šé 03, 05, 07 ç­‰ X-defã€‚
- du$_{(03,04)}$: ç„¡æ­¤å¯èƒ½ã€‚
- du$_{(03,08)}$: (11, 1)
- du$_{(05,07)}$: (9, 2)
- du$_{(07,08)}$: (2, 11)

æ‰€ä»¥æˆ‘å€‘å¯ä»¥è¨­è¨ˆæ¸¬è©¦æ¡ˆä¾‹ {(11,1), (9,2), (9,-2), (11,1), (2,11)} ä¾†æ»¿è¶³é€™å€‹éœ€æ±‚ã€‚

### è³‡æ–™æµæ¸¬è©¦æ¶µè“‹åº¦

:question: è‹¥åˆ†æ”¯æ¶µè“‹åº¦ç‚ºç™¾åˆ†ç™¾ï¼Œå‰‡è³‡æ–™æµæ¸¬è©¦æ¶µè“‹åº¦ $du$ ä¹Ÿæœƒç™¾åˆ†ç™¾å—ï¼Ÿ


ä»¥ä»¥ä¸‹çš„ä¾‹å­åšæ€è€ƒ

```java=
 read (x, y);
 if (p)
    x++;
 else 
    print (y);
 if (q)
    print y;
 else
    y = x + 1;
  print (x, y);                 
```

ç•¶ (p,q) = (t,t), (f,f)  branch coverage å·²ç¶“ 100%ï¼Œä½† x çš„ du path ä¸¦æ²’æœ‰é€šé(3, 9)ã€‚

## è®Šç•°æ¸¬è©¦
è®Šç•°æ¸¬è©¦æ˜¯ä¸€å€‹å¾ˆæœ‰è¶£çš„æ–¹æ³•ï¼Œå®ƒä¸¦ä¸æ˜¯çœŸçš„æ¸¬è©¦ç¨‹å¼ç¢¼æˆ–ç³»çµ±è¦æ ¼ï¼Œè€Œæ˜¯æ¸¬è©¦ã€Œæ¸¬è©¦è³‡æ–™ã€‚ç•¶æˆ‘å€‘çš„æ¸¬è©¦è³‡æ–™å¤ªå°‘æˆ–æ˜¯ä¸å¤ å°–éŠ³æ™‚ï¼Œå®ƒæ˜¯ç„¡æ³•æ‰¾å‡ºç¨‹å¼çš„éŒ¯èª¤çš„ã€‚

![mutation testing](https://hackmd.io/_uploads/H1ft65b4a.png)

ä¸Šåœ–èªªæ˜è®Šç•°æ¸¬è©¦çš„æ¦‚å¿µã€‚T ç‚ºæ¸¬è©¦ P çš„æ¸¬è©¦è³‡æ–™ã€‚æˆ‘å€‘å°‡ P åšä¸€äº›å¾®å¹…ä¿®æ”¹å¾Œç”¢ç”Ÿæ•¸å€‹è®Šç•°é«”ï¼ˆmutantï¼‰$P^{'}$, $P^{''}$, $P^{'''}$ èˆ‡ $P^{''''}$ã€‚å¦‚æœ T ç„¡æ³•å€åˆ† $P$ èˆ‡è®Šç•°é«”çš„è¼¸å‡ºå·®ç•°ï¼Œå‰‡ T ç„¡æ•ˆï¼Œå¿…é ˆæ›´æ›æˆ–æ˜¯æ–°å¢ã€‚

ä¾‹å¦‚ä¸€å€‹ç¨‹å¼ä¸­æœ‰ä¸€å€‹åˆ¤æ–· `a>=2`, æˆ‘å€‘ç”¢ç”Ÿè®Šç•°ç‚º `a>2`ï¼Œå¦‚æœæˆ‘å€‘ç”¨ `a=2` çš„æ¸¬è©¦è³‡æ–™ä¾†åŸ·è¡Œé€™å…©å€‹ç¨‹å¼ï¼Œå¯ä»¥çŸ¥é“ç¬¬ä¸€å€‹æ¢ä»¶æœƒé€²å»ï¼Œè€Œç¬¬äºŒå€‹ä¸æœƒé€²å»ï¼Œé€™å…©å€‹ç¨‹å¼åŸ·è¡Œçµæœå› æ­¤å¯èƒ½ä¸åŒã€‚æ‰€ä»¥æˆ‘å€‘èªª `a=2` çš„æ¸¬è©¦è³‡æ–™æ˜¯ä¸€å€‹æœ‰æ•ˆæ¸¬è©¦ï¼Œå¯ä»¥è­˜åˆ¥å…©å€‹å·®ç•°ã€‚åä¹‹ï¼Œå¦‚æœæ¸¬è©¦è³‡æ–™æ˜¯ `a=3`, åœ¨ä¸Šé¢çš„å…©å€‹æ¢ä»¶éƒ½ä¸€æ¨£æœƒé€²å»ï¼Œçµæœå¯èƒ½æ˜¯ç›¸åŒçš„ã€‚


### è®Šç•°


æ‰€è¬‚çš„è®Šç•°æŒ‡çš„æ˜¯å—æ¸¬ç¨‹å¼çš„å¾®å¹…ä¿®æ”¹ã€‚ä¾‹å¦‚æŠŠéƒ¨åˆ†çš„ = æ”¹æˆ != æˆ–æ˜¯ > æ”¹æˆ <ï¼Œå¦‚æœé€£é€™æ¨£çš„éŒ¯èª¤æ¸¬è©¦è³‡æ–™éƒ½ç„¡æ³•åµæŸ¥è™•ç†ï¼Œè¡¨ç¤ºæ­¤è³‡æ–™æ˜¯ä¸å¤ çš„ã€‚ä¿®æ”¹ç¨‹å¼çš„é‹ç®—å…ƒï¼ˆoperatorï¼‰æˆ‘å€‘ç¨±ç‚º è®Šç•°é‹ç®—å…ƒï¼ˆmutation operatorï¼‰ï¼Œä¾‹å¦‚ï¼š

- æŠŠæŸäº›åˆ¤æ–·å¥æ›æˆ true, false, æˆ–åŠ ä¸Š not
- æŠŠ + æ›æˆ *, - æ›æˆ /
- æŠŠ > æ›æˆ >=, == æˆ–æ˜¯ !=
- æŠŠæŸäº›é‹ç®—ä½œç‚ºå¹…çš„ä¿®æ”¹ï¼Œä¾‹å¦‚ x è®Šæˆ x+1, y æ›æˆ y-1

ä¾‹å¦‚ï¼ŒåŸç¨‹å¼ç‚ºï¼š

```java
int getMax(int x, int y) {
   int max;   
   if (x>y) max =x;
   else max = y;
   return max;
}
```

è®Šç•°å¾Œçš„ç‚ºï¼š

```java
int getMax2(int x, int y) {
   int max;   
   if (x<y) max =x;
   else max = y;
   return max;
}
```

å‡è¨­ä½ åªæœ‰ä¸€çµ„æ¸¬è©¦è³‡æ–™ (1,1), å‰‡åœ¨ getMax() èˆ‡ getMax2() åŸ·è¡Œå‡ºä¾†çš„çµæœéƒ½æ˜¯ä¸€æ¨£çš„ï¼Œä»£è¡¨æ¸¬è©¦è³‡æ–™ä¸è¶³ã€‚

### ä½œæ³•


- ç”¢ç”Ÿç¨‹å¼ (P) çš„è®Šç•°ç¾¤ï¼Œ$P^m =\{P_1, P_2, P_i, ... P_n\}$;
- T ç‚ºæ¸¬è©¦è³‡æ–™é›†åˆï¼Œ$T = \{t_1, t_2, ... t_m\}$;
- ç”¨ T ä¾†æ¸¬è©¦ P åŠ $P^m$ å…§çš„æ¯å€‹ç¨‹å¼ï¼Œç•¶ $\exists t_i \in T, P(t_i) \neq P_j(t_i)$ æ™‚ï¼Œè¡¨ç¤º $t_i$ å¯ä»¥è­˜åˆ¥å‡ºå…©è€…çš„å·®ç•°ï¼Œæ­¤æ™‚ $P_j$ è¢«ç§»é™¤ï¼Œç¨±ä¹‹ç‚ºè¢«åˆªé™¤è®Šç•°é«”ï¼ˆkilled mutantï¼‰ï¼Œæ²’æœ‰è¢«ç§»é™¤çš„ç¨±ä¹‹ç‚ºå­˜æ´»è®Šç•°é«”ï¼ˆalive mutantï¼‰ã€‚
- å¦‚æœå‰©ä¸‹çš„ å­˜æ´»è®Šç•°é«” ä¸æ˜¯ç­‰åƒ¹è®Šç•°ï¼Œå‰‡å¢åŠ æ¸¬è©¦æ¡ˆä¾‹ã€‚
- å›åˆ°æ­¥é©Ÿ 3ï¼Œç›´åˆ° å­˜æ´»è®Šç•°é«” ç‚ºç©ºã€‚

:::success
:football: è€ƒæ…®ä»¥ä¸‹çš„ç¨‹å¼ *P*ã€‚è‹¥æˆ‘å€‘æœ‰å…©å€‹è®Šç•° $P_1$ æ˜¯æŠŠ && æ”¹æˆ ||ï¼Œ $P_2$ æ˜¯æŠŠ == æ”¹æˆ <=ï¼Œè«‹å• test case (x=10, y=10) èƒ½å¤  kill å“ªäº›è®Šç•°ï¼Ÿå…¶æ‰€ä»£è¡¨çš„æ¶µæ„ç‚ºä½•ï¼Ÿ

```java
read(X, Y)
if ((X>=10) && (Y==1))
   X=1;
else if ((X-Y) < 2)
   X=2;
if (Y >10)
   X=3;
print X
```
:::

æ¸¬è©¦æ¡ˆä¾‹ (10, 10) å°åŸä¾† $P$ çš„æ¸¬è©¦ $P(10,10)$ ç”¢å‡ºçš„çµæœç‚º $X=2$ï¼Œ$P_1(10,10)$ ç‚º $X=1$ï¼Œè¼¸å‡ºçš„çµæœä¸åŒäº†ï¼Œè¡¨ç¤ºæ­¤æ¸¬è©¦æ¡ˆä¾‹èƒ½å¤ åµæ¸¬å‡ºä¸åŒï¼Œæ•…åˆªé™¤ï¼ˆkillï¼‰$P_1$ã€‚$P_2(10,10)$ çµæœä»ç„¶ç‚º $X=2$ ä¿æŒä¸è®Šï¼Œç„¡æ³•åˆªé™¤ $P_2$ã€‚å› æ­¤æˆ‘å€‘å¿…é ˆå†åŠ å…¥æ¸¬è©¦æ¡ˆä¾‹ã€‚

ä¾‹å¦‚æˆ‘å€‘åŠ å…¥ (10,1) çš„æ¸¬è©¦æ¡ˆä¾‹ï¼Œ$P(10, 1)$ ç‚º 1, $P_2(10, 1)$ ç‚º10, å…©è€…ä¸åŒï¼Œé€™æ™‚å€™æˆ‘å€‘å¯ä»¥åˆªé™¤ $P_2$, å› ç‚ºæ‰€æœ‰çš„è®Šç•°éƒ½è¢«ç§»é™¤ï¼Œæ‰€ä»¥æ¸¬è©¦æ¡ˆä¾‹ OKã€‚

[Google sheet](https://docs.google.com/spreadsheets/d/1rQHYbLEIgeBqpIESXBTk0DTgKF4m_AWo4rO4-_MLiCw/edit?usp=sharing)

### è®Šç•°åˆªé™¤ç‡

è®Šç•°åˆªé™¤ç‡ (mutation score) ç”¨ä¾†æª¢è¦–æ¸¬è©¦è³‡æ–™çš„å®Œæ•´åº¦ã€‚

$ms=K/(Mâ€“E)$

å…¶ä¸­ K æ˜¯è¢«åˆªé™¤è®Šç•°é«”çš„å€‹æ•¸ï¼ŒE æ˜¯ç­‰åƒ¹è®Šç•°é«”çš„å€‹æ•¸ï¼ŒM æ˜¯è®Šç•°çš„å€‹æ•¸ã€‚

è®Šç•°åˆªé™¤ç‡è¶Šé«˜ï¼Œè¡¨ç¤ºæ¸¬è©¦æ¡ˆä¾‹è¶Šæœ‰æ•ˆã€‚

> åœ¨è®Šç•°æ¸¬è©¦é€™å€‹éŠæˆ²ä¸­ï¼Œæˆ‘å€‘çš„ç›®çš„å°±æ˜¯- ç›¡æ‰€èƒ½çš„ï¼ˆè¨­è¨ˆæ¸¬è©¦è³‡æ–™ä»¥ï¼‰åˆªé™¤è®Šç•°ã€‚

### ç­‰åƒ¹è®Šç•°

æœ‰äº›è®Šç•°å¾Œç¨‹å¼ç¢¼çš„è¡Œç‚ºæ˜¯ä¸€æ¨£çš„ï¼Œæ‰€ä»¥ä¸è«–æ¸¬è©¦è³‡æ–™å¤šéº¼å¥½ï¼Œä¹Ÿç„¡æ³•è§€å¯Ÿå‡ºå·®ç•°é€²è€Œåˆªé™¤ï¼Œä¾‹å¦‚ï¼š

```
var a, b, c: integer;
begin
     if a < b then c:= a; 
end

ä»¥ä¸‹ç‚ºä¸‰å€‹è®Šç•°ï¼š
p1: if a <= b-1 then c := a; 
p2: if a +1 <= b then c:= a; 
p3: if a < b then c:= a + 0;
```

$p_1$, $p_2$, $p_3$ é€™ä¸‰å€‹è®Šç•°éƒ½æ˜¯ç­‰åƒ¹è®Šç•°ï¼Œä»»ä½•è³‡æ–™éƒ½ç„¡æ³•å°‡ä¹‹åˆªé™¤ã€‚

#### ex_mutation_test
:::success
:football: é‡å°ä»¥ä¸‹ç¨‹å¼ P åŠå…¶è®Šç•°ï¼Œå›ç­” (1) å“ªäº›æ˜¯ è¢«åˆªé™¤è®Šç•°é«”? (2) é€™äº›é€™æ˜¯æ¡ˆä¾‹æœ‰æ•ˆå—ï¼Ÿè®Šç•°åˆªé™¤ç‡ç‚ºä½•ï¼Ÿ(3) æ‰¿2, å¦‚æœæ¸¬è©¦æ¡ˆä¾‹ä¸æœ‰æ•ˆï¼Œè«‹æ–°å¢æ¸¬è©¦æ¡ˆä¾‹ã€‚ 

```python=
t1=[1,2,3]
t2=[1,2,1]
t3=[3,1,2]

def p(a):
    r = 0
    for i in [1,2]:
        if a[i] > a[r]:
            r = i
    return r

def p1(a):
    r = 0
    for i in [0,1,2]:
        if a[i] > a[r]:
            r = i
    return r

def p2(a):
    r = 0
    for i in [1,2]:
        if i > a[r]:
            r = i
    return r

def p3(a):
    r = 0
    for i in [1,2]:
        if a[i] >= a[r]:
            r = i
    return r

def p4(a):
    r = 0
    for i in [1,2]:
        if True:
            r = i
    return r
```
æˆ‘å€‘é€²è¡Œä»¥ä¸‹çš„æª¢é©—ï¼šï¼ˆpython)
```python=
t = [t1, t2, t3]
mu = [p1, p2, p3, p4]

for tc in t:
    print ('Test case: ', tc)
    print ('P : ', p(tc), end='\t')
    print ('P1: ', p1(tc), end='\t')
    print ('P2: ', p2(tc), end='\t')
    print ('P3: ', p3(tc), end='\t')
    print ('P4: ', p4(tc), end='\t')
    for m in mu:
        if p(tc) != m(tc):
            print ('\n Kill the mutation', m)
    print ()
```
:::


---


åœ¨å¯¦å‹™ä¸Šï¼Œè®Šç•°æ¸¬è©¦éœ€è¦æ­é…å·¥å…·æ‰èƒ½ä½¿ç”¨ï¼Œå› ç‚ºä¸€å€‹ç¨‹å¼æ‰€ç”¢ç”Ÿå‡ºçš„è®Šç•°é«”éœ€è¦å¾ˆå¤šï¼Œé€™éœ€è¦è‡ªå‹•åŒ–çš„ç”¢ç”Ÿï¼Œè€Œæ¯”å°è®Šç•°é«”çš„åŸ·è¡Œçµæœèˆ‡åŸç¨‹å¼æ˜¯å¦ç›¸ç•°ä¹Ÿéœ€è¦é€éç³»çµ±è‡ªå‹•æª¢æŸ¥ï¼Œæ‰èƒ½ç™¼æ®æ­¤æ–¹æ³•çš„æ•ˆç›Šã€‚

### ğŸ§‘â€ğŸ’»Labè®Šç•°æ¸¬è©¦

* [nlh lab](https://github.com/nlhsueh/sw-testing24/blob/main/lab/u04_utest/mutation_test.md)
* [PIT mutation test](http://pitest.org/)

## ç·´ç¿’
 
### æ¸¬è©¦æ¶µè“‹åº¦
- ä¸‹åˆ—ä½•è€…ç‚ºçœŸï¼Ÿ
	
    - æ¢ä»¶æ¶µè“‹åº¦ ç‚º 100% å‰‡ æ•˜è¿°æ¶µè“‹åº¦ ä¹Ÿå¿…ç‚º 100%?
    - 100% åˆ†æ”¯æ¶µè“‹åº¦ å‰‡ æ¢ä»¶æ¶µè“‹åº¦ ä¹Ÿç‚º 100%
    - 100% åˆ†æ”¯æ¶µè“‹åº¦ å‰‡ æ•˜è¿°æ¶µè“‹åº¦ ä¹Ÿç‚º 100%
    - 100% å¤šé‡æ¢ä»¶æ¶µè“‹åº¦ å‰‡ 100% åˆ†æ”¯æ¶µè“‹åº¦
	
	
#### ex-coverage-binary-search
:::success
è«‹å¯«å‡ºä¸€å€‹ Binary Search çš„ç¨‹å¼ï¼Œä¸¦è¨­è¨ˆä¸€äº›æ¸¬è©¦æ¡ˆä¾‹ä½¿å¾— 
	
- 100% æ•˜è¿°æ¶µè“‹åº¦ 
- 100% åˆ†æ”¯æ¶µè“‹åº¦
- 100% æ¢ä»¶æ¶µè“‹åº¦
	
```java
int binary_search(int A[], int key, int imin, int imax) {
  while (imin < imax)    {
       int imid = (int)floor((imin+imax)/2.0);
       assert(imid < imax);
       if (A[imid] < key)
           imin = imid + 1;
       else
           imax = imid;
   }
   if ((imax == imin) && (A[imin] == key))
        return imin;
   else
        return KEY_NOT_FOUND;
}
```	
:::

#### ex-coverage-xy	
:::success
:football: é‡å°ä»¥ä¸‹ç¨‹å¼ 
	
```java
read(X, Y)
if ((X>10) && (Y==1))
   X=1;
else if ((X-Y) < 2)
   X=2;
if (Y >10)
   X=3;
print X	
```

- è¨­è¨ˆä¸€æ¸¬è©¦æ¡ˆä¾‹ä½¿å¾— æ•˜è¿°æ¶µè“‹åº¦ (SC) ç‚º100%; 
- è¨­è¨ˆä¸€æ¸¬è©¦æ¡ˆä¾‹ä½¿å¾— æ¢ä»¶æ¶µè“‹åº¦ (CC) ç‚º 100%, ä½† åˆ†æ”¯æ¶µè“‹åº¦ (BC) ä¸ç‚º 100% 
- è¨­è¨ˆä¸€æ¸¬è©¦æ¡ˆä¾‹ä½¿å¾— CC=100% , BC<>100% 
- è¨­è¨ˆä¸€æ¸¬è©¦æ¡ˆä¾‹ä½¿å¾— CC=BC=100%
:::


#### ex-triangle
:::success
é‡å°ä»¥ä¸‹ç¨‹å¼ï¼Œè¨­è¨ˆæ¸¬è©¦æ¡ˆä¾‹ï¼Œä½¿ä¹‹100% condition coverage

```java
public class Triangle {
    public static String getTriangleType(double a, double b, double c) {
        if (a <= 0 || b <= 0 || c <= 0 || a + b <= c || a + c <= b || b + c <= a) {
            return "Not a valid triangle";
        }

        // Check for equilateral triangle
        if (a == b && b == c && c == a) {
            return "Equilateral";
        }

        // Check for isosceles triangle
        if (a == b || b == c || a == c) {
            return "Isosceles";
        }

        // Otherwise, it's a scalene triangle
        return "Scalene"; // ä¸ç­‰é‚Šä¸‰è§’å½¢
    }

}
```
:::
		

#### ex-coverage-bmi
:::success
é‡å°ä»¥ä¸‹ç¨‹å¼ï¼Œè¨­è¨ˆæ¸¬è©¦æ¡ˆä¾‹ï¼Œä»¥é”åˆ°æœ€ä½³çš„åˆ†æ”¯åŒ…å«åº¦ã€‚
```java
if (height > 2 || height <= 1) 
   return -1;
if (weight > 120 || weight <= 40) 
   return -2;
double BMI = weight /(height*height);
if (BMI > 30) return -3;
if (BMI < 15) return -4;
return BMI;
```		
:::


#### ex-coverage-triangle
:::success
å¯«ä¸€å€‹ç¨‹å¼åˆ¤æ–·ä¸‰è§’å½¢ï¼Œä¸¦å¯«ä¸€é» JUnit æ¸¬è©¦ç¢¼ï¼ŒåŸ·è¡Œæ¸¬è©¦æ™‚ï¼Œä»¥coverage testing è§€å¯Ÿæ¸¬è©¦æ¶µè“‹åº¦ï¼Œé€æ­¥æé«˜æ¸¬è©¦ç‡ã€‚
:::


### åŸºæœ¬è·¯å¾‘æ¸¬è©¦

- ä»¥ä¸‹ä½•è€…ç‚ºçœŸï¼ˆé¸ä¸‰ï¼‰
	
    - ç¹ªè£½æµç¨‹åœ–æ™‚ï¼Œè¤‡åˆæ¢ä»¶å¿…é ˆåˆ†è§£ç‚ºå–®ä¸€æ¢ä»¶;
    - ç¨‹å¼ä¸­çš„é‚è¼¯åˆ¤æ–·è¶Šå¤šï¼Œè¨ˆç®—è¿¥åœˆè¤‡é›œåº¦ (CC) çš„å€¼è¶Šé«˜;
    - CC ç‚º n, è¡¨ç¤ºè‡³å°‘éœ€è¦ n å€‹æ¸¬è©¦æ¡ˆä¾‹;
    - è‹¥ä¸€å€‹ç¨‹å¼éƒ½æ²’æœ‰åˆ¤æ–·æ•˜è¿°å¥ï¼Œå‰‡å…¶ CC ç‚º 0;
    - åŸºæœ¬è·¯å¾‘æ¸¬è©¦è¦æ±‚åˆ†æ”¯æ¶µè“‹åº¦ç™¾åˆ†ç™¾ã€‚
	
å›ç­”ä»¥ä¸‹å•é¡Œ    
    - è«‹æè¿° basis path testing çš„æ­¥é©Ÿ
    - ä½•è¬‚ç¨ç«‹è·¯å¾‘ï¼ˆindependent pathï¼‰ï¼Ÿ
    - ä½•è¬‚ cyclomatic complexity? å®ƒåœ¨ basis path testing çš„æ„ç¾©ç‚ºä½•ï¼Ÿ

- è«‹å¯«å‡ºä¸€å€‹ selection sort çš„ç¨‹å¼ï¼Œé€²è¡Œ basis path testing çš„è¨­è¨ˆã€‚

#### ex-basis-path-testing-next-date
:::success
:football: é‡å°ç¨‹å¼ [nextDate](#code-nextDate)ï¼Œåˆ©ç”¨ basis path testing çš„æ–¹å¼è¨­è¨ˆæ¸¬è©¦æ¡ˆä¾‹ã€‚
	
	- Cyclomatic complexity ç‚ºä½•
	- Independent path ç‚ºä½•ï¼Ÿ
	- è¨­è¨ˆæ¸¬è©¦æ¡ˆä¾‹
:::

#### code-nextDate
```java
  nextDate(): 
  read(m, d);
  if (d == 28) {
      if (m == 2) {
         m++;
         d = 1;
      }
      else d++;   
  }
  else if (d == 30) {
     if (m == 4 or 6 or 9 or 11) {
         m++;
         d=1;
     }   
     else d++;
  }
  else if (d == 31) {
     if (m == 1 or 3 or 5 or 7 or 8 or 10) {
        d=1;
        m++;
     } 
     else if (m == 12) {
        d=1; m=1;
     }     
  }
  else d++;
  print (m, d);
}
```

### è³‡æ–™æµæ¸¬è©¦

- é—œæ–¼è³‡æ–™æµæ¸¬è©¦ï¼Œä»¥ä¸‹ä½•è€…ç‚ºéŒ¯ï¼ˆé¸ä¸€ï¼‰ï¼š
	
	- è‘—é‡åœ¨è³‡æ–™è®Šæ•¸å®šç¾©ã€è¨ˆç®—ã€èˆ‡åˆ¤æ–·ä¹‹é–“çš„é—œä¿‚; 
	- if (x>10) æ˜¯ä¸€ç¨®å° x è®Šæ•¸çš„ p-use; 
	- å…¨åˆ¤æ–·åˆ©ç”¨æ¸¬è©¦ (all p-use) çš„æ¸¬è©¦è³‡æ–™å¿…å®šåŒ…å«å…¨è¨ˆç®—æ¸¬è©¦ (all c-use) çš„æ¸¬è©¦è³‡æ–™; 
	- å…¨ä½¿ç”¨è³‡æ–™æµæ¸¬è©¦ (all du) æ˜¯è³‡æ–™æµæ¸¬è©¦ä¸­æœ€å®Œæ•´çš„æ¸¬è©¦æ–¹æ³•ã€‚

- å›ç­”ä»¥ä¸‹å•é¡Œ
    - ä½•è¬‚ è³‡æ–™æµæ¸¬è©¦? 
    - è«‹å¯«å‡ºä¸€å€‹ selection sort çš„ç¨‹å¼ï¼Œé€²è¡Œ all p-use è³‡æ–™æµæ¸¬è©¦ã€‚


:::success
:football: é‡å° [nextDate](#code-nextDate) é€²è¡Œè³‡æ–™æµæ¸¬è©¦ï¼š
	
	- All definition testing 
	- All c-use testing
:::
	

### è®Šç•°æ¸¬è©¦

- é—œæ–¼è®Šç•°æ¸¬è©¦ï¼Œä½•è€…æ­£ç¢º 
	
	- å­˜æ´»è®Šç•°é«” (alive mutant) è¶Šå¤šï¼Œè¡¨ç¤ºè©²æ¸¬è©¦æ¡ˆä¾‹é›†è¶Šæœ‰æ•ˆ;
	- å·²åˆªé™¤è®Šç•°é«” (killed mutant) è¡¨ç¤ºè©²ç¨‹å¼æ˜¯ä¸€å€‹æœ‰éŒ¯èª¤çš„ç¨‹å¼;
	- ã€Œè®Šç•°åˆªé™¤ç‡ã€ç”¨ä¾†è¨ˆç®—ç¨‹å¼çš„å“è³ª;
	-  è®Šç•°é‹ç®—å…ƒï¼ˆmutation operatorï¼‰ç”¨ä¾†ä¿®æ”¹æ¸¬è©¦ç¢¼;
	- è®Šç•°ä¸»è¦ç›®çš„åœ¨è‡ªå‹•åŒ–ç”¢ç”Ÿæ¸¬è©¦æ¡ˆä¾‹;
	

- å›ç­”ä»¥ä¸‹å•é¡Œï¼š
	
	-  ä½•è¬‚è®Šç•°é«”? ä½•è¬‚ç­‰åƒ¹è®Šç•°é«”ï¼Ÿ
	-  å·²åˆªé™¤è®Šç•°é«” (killed mutant) çš„å«æ„ç‚ºä½•ï¼Ÿå­˜æ´»è®Šç•°é«” (alive mutant) çš„å«æ„ç‚ºä½•ï¼Ÿ 
	- èªªæ˜è®Šç•°æ¸¬è©¦çš„æµç¨‹ 
	-  åˆªé™¤è®Šç•°ç‡çš„å®šç¾©ç‚ºä½•ï¼Ÿæ‰€ä»£è¡¨çš„å«æ„ç‚ºä½•ï¼Ÿ
	- èˆ‰å‡ºä¸‰å€‹è®Šç•°é‹ç®—å…ƒ	
		


- ä»¥ä¸‹ P2 ç‚º Pçš„ mutant, è«‹å•å…©è€…æ˜¯å¦ç­‰åƒ¹ï¼Ÿ
```java
//P
int index=0;
while (â€¦) {
  â€¦ ;
  index++;
  if (index==10)
    break;
}

//P2
int index=0;
while (â€¦) {
  â€¦ ;
  index++;
  if (index>=10)
    break;
}
```

#### ex-mutation-xy
:::success
:football: è®Šç•°æ¸¬è©¦
é‡å°ä¸‹æ–¹æ­¤ç¨‹å¼ï¼Œæˆ‘å€‘æ¡ç”¨ mutation test çš„æ–¹å¼ä¾†æª¢é©—æ¸¬è©¦æ¡ˆä¾‹ï¼Œå‡è¨­æˆ‘å€‘ç”¢ç”Ÿä»¥ä¸‹è®Šç•°ï¼š
* P1 æ˜¯æŠŠç¬¬äºŒè¡Œçš„ && æ”¹æˆ || (or)
* P2 æ˜¯æŠŠ == æ”¹æˆ >=
* P3 æ˜¯æŠŠç¬¬å››è¡Œçš„ < æ”¹æˆ <=
* P4 æ˜¯æŠŠç¬¬å…­è¡Œçš„ > æ”¹ç‚º >= 
* P5 æ˜¯æŠŠç¬¬ä¸ƒè¡Œçš„ X=3 æ”¹ç‚º X=1

è«‹åƒè€ƒ [æ­¤ç¯„ä¾‹](#ex_mutation_test) çš„åšæ³•
* test case (x,y)= (1,1), (11,11), (3,3) èƒ½å¤  kill å“ªäº›è®Šç•°ï¼Ÿå…¶æ‰€ä»£è¡¨çš„æ¶µæ„ç‚ºä½•ï¼Ÿ

```python=
def func(X, Y):
    if ((X>10) and (Y==1))
       X=1;
    else if ((X-Y) < 2)
       X=2;
    if (Y >10)
       X=3;
    return X
```
* å»¶ä¼¸ [æ­¤ç¯„ä¾‹](#ex_mutation_test) çš„ç¨‹å¼ç¢¼ï¼Œè¨­è¨ˆä¸€å€‹ mu_score å‡½å¼å¯ä»¥æª¢é©—ä¸€å€‹æ¸¬è©¦æ¡ˆä¾‹ç¾¤é‡å°ä¸€ç¾¤è®Šç•°é«”çš„è®Šç•°å€¼ã€‚

```python=
def mu_score(Pt, Mt):
    ''' 
        Pt: [t1, t2, ...] ä¸€ç¶­ list
        Mt: [M1t, M2t, ...] äºŒç¶­ list
          Mit: [M1t1, M1t2, ...]
    '''
```
:::


### ç¶œåˆ
- ä»¥ä¸‹ä½•è€…ç‚ºçœŸ
	
	- æ‡‰ç”¨ Eclemma ä¾†é€²è¡Œæ¸¬è©¦æ˜¯å±¬æ–¼é»‘ç®±æ¸¬è©¦
	- å¦‚æœ 100% branch coverage ä¸”çµæœéƒ½æ­£ç¢º, å‰‡ä¿è­‰ç¨‹å¼çš„åŠŸèƒ½éƒ½æ­£ç¢ºäº†
	- æŒ‰ç…§ basic path testing çš„æ–¹æ³•æ‰€è¨­è¨ˆå‡ºçš„æ¸¬è©¦æ¡ˆä¾‹æœƒé”åˆ° 100% branch coverage å’Œ 100% condition coverage
	- mutation test ä¸¦ä¸æ˜¯ä¸€ç¨®æ¸¬è©¦æ–¹æ³•ï¼Œå®ƒæ˜¯ä¸€ç¨®æª¢é©—æ¸¬è©¦æ¡ˆä¾‹çš„æ–¹æ³•
- åœ¨å¯¦å‹™ä¸Šï¼Œmutation ä¸€å®šè¦å·¥å…·è¼”åŠ©æ‰æœ‰åŠŸæ•ˆ
	

